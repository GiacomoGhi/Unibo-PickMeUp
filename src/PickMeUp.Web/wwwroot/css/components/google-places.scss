// ============================================================================
// GOOGLE PLACES AUTOCOMPLETE COMPONENT
// ============================================================================
// Styling for Google Places API autocomplete dropdown and related elements
// ============================================================================

// ============================================================================
// PLACE AUTOCOMPLETE ELEMENT (New Web Component)
// ============================================================================

// Style the new PlaceAutocompleteElement web component
gmp-place-autocomplete {
  width: 100%;

  // Style the internal input
  input {
    background: $white;
    border: 2px solid $gray-300;
    padding: $spacing-sm;
    border-radius: $radius-lg;
    width: 100%;
    font-size: $font-size-base;
    font-family: $font-family-base;
    color: $text-primary;
    transition: border-color $transition-fast, box-shadow $transition-fast;

    &:focus {
      outline: none;
      border-color: $primary-500;
      box-shadow: 0 0 0 3px rgba($primary-500, 0.2);
    }

    &::placeholder {
      color: $gray-400;
    }
  }

  // Valid state
  &.is-valid input {
    border-color: $success-500;
    padding-right: calc(1.5em + #{$spacing-md});
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%2322c55e' d='M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right $spacing-sm center;
    background-size: 1.25em 1.25em;

    &:focus {
      border-color: $success-600;
      box-shadow: 0 0 0 3px rgba($success-500, 0.2);
    }
  }

  // Invalid state
  &.is-invalid input {
    border-color: $danger-500;
    padding-right: calc(1.5em + #{$spacing-md});
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23ef4444'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23ef4444' stroke='none'/%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right $spacing-sm center;
    background-size: 1.25em 1.25em;

    &:focus {
      border-color: $danger-600;
      box-shadow: 0 0 0 3px rgba($danger-500, 0.2);
    }
  }
}

// ============================================================================
// AUTOCOMPLETE DROPDOWN (Google-generated container)
// ============================================================================

// Override Google's default styles for the autocomplete dropdown
.pac-container {
  background-color: $white;
  border: 1px solid $gray-200;
  border-radius: $radius-lg;
  box-shadow: $shadow-lg;
  margin-top: $spacing-xs;
  font-family: $font-family-base;
  z-index: 9999;

  // Individual autocomplete item
  .pac-item {
    padding: $spacing-sm $spacing-md;
    border-top: 1px solid $gray-200;
    cursor: pointer;
    line-height: $line-height-normal;
    transition: background-color $transition-fast;
    font-size: $font-size-base;
    color: $text-primary;

    &:first-child {
      border-top: none;
    }

    &:hover {
      background-color: $gray-50;
    }

    &:focus,
    &.pac-item-selected {
      background-color: $primary-50;
    }
  }

  // Icon before each item
  .pac-icon {
    margin-right: $spacing-sm;
    width: 16px;
    height: 16px;
    background-size: contain;
  }

  // The matched query text
  .pac-item-query {
    font-weight: $font-weight-semibold;
    color: $primary-600;
  }

  // Google logo attribution
  .pac-logo::after {
    padding: $spacing-xs $spacing-sm;
    font-size: $font-size-xs;
    color: $gray-500;
  }
}

// ============================================================================
// FORM CONTROL VALIDATION STATES
// ============================================================================

.pmu-form-control {
  // Valid state (address selected from autocomplete)
  &.is-valid {
    border-color: $success-500;
    padding-right: calc(1.5em + #{$spacing-md});
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%2322c55e' d='M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right $spacing-sm center;
    background-size: 1.25em 1.25em;

    &:focus {
      border-color: $success-600;
      box-shadow: 0 0 0 3px rgba($success-500, 0.2);
    }
  }

  // Invalid state (address not selected or invalid)
  &.is-invalid {
    border-color: $danger-500;
    padding-right: calc(1.5em + #{$spacing-md});
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23ef4444'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23ef4444' stroke='none'/%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right $spacing-sm center;
    background-size: 1.25em 1.25em;

    &:focus {
      border-color: $danger-600;
      box-shadow: 0 0 0 3px rgba($danger-500, 0.2);
    }
  }

  // Loading state (while autocomplete is initializing or fetching)
  &.autocomplete-loading {
    padding-right: calc(1.5em + #{$spacing-md});
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3e%3cpath fill='%236b7280' d='M12,4a8,8,0,0,1,7.89,6.7A1.53,1.53,0,0,0,21.38,12h0a1.5,1.5,0,0,0,1.48-1.75,11,11,0,0,0-21.72,0A1.5,1.5,0,0,0,2.62,12h0a1.53,1.53,0,0,0,1.49-1.3A8,8,0,0,1,12,4Z'%3e%3canimateTransform attributeName='transform' type='rotate' dur='0.75s' values='0 12 12;360 12 12' repeatCount='indefinite'/%3e%3c/path%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right $spacing-sm center;
    background-size: 1.25em 1.25em;
  }
}

// ============================================================================
// VALIDATION FEEDBACK MESSAGES
// ============================================================================

.invalid-feedback {
  display: none;
  width: 100%;
  margin-top: $spacing-xs;
  font-size: $font-size-sm;
  color: $danger-500;
  font-weight: $font-weight-normal;
}

// Show invalid feedback when form control has is-invalid class
.pmu-form-control.is-invalid ~ .invalid-feedback {
  display: block;
}

.valid-feedback {
  display: none;
  width: 100%;
  margin-top: $spacing-xs;
  font-size: $font-size-sm;
  color: $success-500;
  font-weight: $font-weight-normal;
}

// Show valid feedback when form control has is-valid class
.pmu-form-control.is-valid ~ .valid-feedback {
  display: block;
}

// ============================================================================
// ANIMATIONS
// ============================================================================

// Pulse animation for successful validation
@keyframes pmu-valid-pulse {
  0% {
    box-shadow: 0 0 0 0 rgba($success-500, 0.4);
  }
  70% {
    box-shadow: 0 0 0 10px rgba($success-500, 0);
  }
  100% {
    box-shadow: 0 0 0 0 rgba($success-500, 0);
  }
}

// Apply animation when field becomes valid
.pmu-form-control.is-valid:not(:focus) {
  animation: pmu-valid-pulse 0.6s ease-out;
}

// ============================================================================
// RESPONSIVE ADJUSTMENTS
// ============================================================================

@media (max-width: $breakpoint-sm) {
  // Make dropdown full width on mobile
  .pac-container {
    left: 0 !important;
    right: 0 !important;
    width: auto !important;
    margin-left: $spacing-sm;
    margin-right: $spacing-sm;
  }

  .pac-item {
    padding: $spacing-xs $spacing-sm;
    font-size: $font-size-sm;
  }
}

// ============================================================================
// DARK THEME SUPPORT (Future)
// ============================================================================

// Placeholder for dark theme support
// Will be activated when dark theme is implemented
/*
@media (prefers-color-scheme: dark) {
  .pac-container {
    background-color: $dark-bg-primary;
    border-color: $dark-border;

    .pac-item {
      color: $dark-text-primary;
      border-top-color: $dark-border;

      &:hover {
        background-color: $dark-bg-secondary;
      }

      &.pac-item-selected {
        background-color: rgba($primary-500, 0.2);
      }

      .pac-item-query {
        color: $primary-400;
      }
    }
  }
}
*/
