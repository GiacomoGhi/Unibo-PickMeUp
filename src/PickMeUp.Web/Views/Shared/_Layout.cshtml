@{
    Layout = "_LayoutHtml";
    var isAuthenticated = User?.Identity?.IsAuthenticated == true;
    var userEmail = User?.FindFirst(System.Security.Claims.ClaimTypes.Email)?.Value;
}
@section metas{
    @RenderSection("metas", false)
}
@section styles{
    @RenderSection("styles", false)
}

<!-- Main Layout -->
<div class="pmu-hero">
    <nav class="navbar navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="@Url.Action(MVC.Home.Landing())">
                <img class="app-logo" src="~/images/app-logo.png" alt="Pick-me-UP" />
                <span class="brand-text">Pick-me-UP</span>
            </a>
            
            <div class="navbar-nav ms-auto d-flex flex-row align-items-center">
                <span class="badge bg-secondary me-3">demo</span>
                
                @if (isAuthenticated)
                {
                    <div class="trips-tab me-3">
                        <a href="@Url.Action(MVC.Home.Landing())" class="pmu-btn pmu-btn-warning">
                            I Tuoi Viaggi
                        </a>
                    </div>
                    
                    <div class="dropdown">
                        <button class="pmu-btn pmu-btn-primary pmu-btn-profile dropdown-toggle" type="button" data-bs-toggle="dropdown">
                            <i class="fa-solid fa-user"></i>
                            <span>@userEmail</span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="@Url.Action(MVC.Home.Landing())">Home</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <a class="dropdown-item" href="javascript:void(0)" onclick="document.getElementById('POST_LogOut').submit()">
                                    <i class="fa-solid fa-right-from-bracket"></i> Esci
                                </a>
                            </li>
                        </ul>
                    </div>
                    <form autocomplete="off" method="post" action="@Url.Action(MVC.Auth.Logout())" id="POST_LogOut" style="display:none"></form>
                }
                else
                {
                    <button class="pmu-btn pmu-btn-primary pmu-btn-profile me-2" data-bs-toggle="modal" data-bs-target="#loginModal">
                        <i class="fa-solid fa-user"></i>
                        <span>ACCEDI</span>
                    </button>
                }
            </div>
        </div>
    </nav>

    @RenderBody()
</div>

<footer class="pmu-footer">
    <p>© 2025 PickMeUp - Find your way</p>
</footer>

@section googlehead{
    @RenderSection("googlehead", false)
}

@section scripts{
    <script type="text/javascript">
        @this.RenderAlertsWithToastify()
    </script>
    
    @RenderSection("appInit", false)
    @RenderSection("scripts", false)
}

<partial name="Modals/_LoginModal" />
<partial name="Modals/_SignupModal" />
<partial name="Modals/_ResetPasswordModal" />
<partial name="Modals/_ResendConfirmationModal" />
<partial name="Modals/_AccountActivationModal" />
<partial name="Modals/_PasswordResetSentModal" />
